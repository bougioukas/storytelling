---
title: "Radial chart"
---

```{r}
#| include: false
library(fontawesome)
```


We need to load the following packages:

```{r}
#| message: false
#| warning: false

library(tidyverse)
library(ggnewscale)
```


The chart we are set to recreate, originally obtained from [1 dataset 100 visualizations](https://100.datavizproject.com/data-type/viz79/) created by ferdio.


::: {#fig-ourworldindata}
[![](img/original_radial.png)](https://100.datavizproject.com/data-type/viz79/)

The original graph obtained from 1 dataset 100 visualizations created by ferdio.
:::



First, we create the dataframes in R:

```{r}
#| warning: false

df <- tibble(
  x = c(8, 10, 15, 5, 4, 13),
  y = c(1:3, 1:3),
  country = c("Norway", "Denmark", "Sweeden", "Norway", "Denmark", "Sweeden"),
  group = c("group1", "group1", "group1", "group2", "group2", "group2")
)

# set the colors
cols1 <- c("#F9BBB3", "#7A8092",  "#79B0F6")
cols2 <- c("#EE5440", "#283250", "#3274D8")

```





```{r}
#| label: fig-final
#| fig-cap: Final chart
#| fig-width: 14
#| fig-height: 14


df |> 
ggplot() +
  geom_segment(data = filter(df, group == "group1"), aes(x = 0, xend = x, y = y, yend = y, 
                               color = country), 
               linewidth = 16, lineend = 'round') +
  geom_text(data = filter(df, group == "group1"), aes(x, y, label = x), color = "white", size = 8) +
  geom_text(data = filter(df, group == "group1"), aes(x = 0, y, label = country), size = 8, hjust = 1.4) +
  scale_color_manual(values = cols1) +
  guides(color = guide_legend(title = paste0(strrep(" ", 5), "After 2004"),
                              override.aes = list(size = c(10, 10, 10)),
                              reverse = TRUE,
                              keywidth = 1.5, order = 1,
                              title.position = "right")) +
  new_scale_color() +
  geom_segment(data = filter(df, group == "group2"), aes(x = 0, xend = x, y = y, yend = y, 
                               color = country),
               linewidth = 16, lineend = 'round') +
  geom_text(data = filter(df, group == "group2"), aes(x, y, label = x), color = "white", size = 8) +
  scale_color_manual(values = cols2) +
  scale_y_continuous(expand = expansion(mult = 0.3), limits = c(0, 3)) +
  scale_x_continuous(limits = c(0, 20)) +
  coord_polar() +
  guides(color = guide_legend(title = paste0(strrep(" ", 5), "Before 2004", strrep(" ", 15)),
                              reverse = TRUE, override.aes = list(size = c(10, 10, 10)),
                              keywidth = 1.5, order = 1,
                              title.position = "right")) +
  theme(panel.background = element_blank(),
        axis.title = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        legend.position = "bottom",
        legend.title = element_text(size = 22, color = "gray50"),
        legend.margin = margin(t = -75, ),
        legend.text = element_blank(),
        legend.spacing.x = unit(-0.5, "mm")
  )
```
